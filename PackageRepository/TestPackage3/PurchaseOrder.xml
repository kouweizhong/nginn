<?xml version="1.0" encoding="utf-8"?>
<process version="1" name="PurchaseOrder" xmlns="http://www.nginn.org/WorkflowDefinition.1_0.xsd" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <places>
    <place id="start" type="StartPlace">
    </place>
    <place id="end" type="EndPlace">
    </place>
    
  </places>
  <tasks>
    <task id="managerApproval" type="ManualTask">
		<joinType>XOR</joinType>
		<splitType>XOR</splitType>
		<data-definition>
			<variables>
				<variable name="requestedById" type="string" required="true" dir="In" />
				<variable name="requestedByName" type="string" required="false" dir="In" />
                <variable name="requestDate" type="date" required="false" dir="In" />
				<variable name="orderItem" type="OrderItem" required="true" isArray="true" dir="In" />
				<variable name="decision" type="string" required="true" dir="Out" />
				<variable name="managerId" type="string" required="true" dir="Out" />
				<variable name="managerComment" type="string" required="false" dir="Out" />
			  </variables>
			  <input-bindings>
			  	<binding>
					<variable>requestedById</variable>
					<bindingType>CopyVar</bindingType>
					<sourceVariable>requestedById</sourceVariable>
				</binding>
				<binding>
					<variable>requestedByName</variable>
					<bindingType>CopyVar</bindingType>
					<sourceVariable>requestedByName</sourceVariable>
				</binding>
				<binding>
					<variable>requestDate</variable>
					<bindingType>CopyVar</bindingType>
					<sourceVariable>requestDate</sourceVariable>
				</binding>
				<binding>
					<variable>orderItem</variable>
					<bindingType>CopyVar</bindingType>
					<sourceVariable>orderItem</sourceVariable>
				</binding>
			  </input-bindings>
			  <output-bindings>
			  </output-bindings>
		</data-definition>
	</task>
	<task id="sendRequestCorrection" type="ManualTask">
		<joinType>XOR</joinType>
		<splitType>XOR</splitType>
	</task>
	<task id="completeOrderItems" type="EmptyTask">
		<joinType>XOR</joinType>
		<splitType>XOR</splitType>
	</task>
	
	<task id="deliverOrderItems" type="ManualTask">
		<joinType>XOR</joinType>
		<splitType>AND</splitType>
	</task>
	
	<task id="confirmOrderComplete" type="ManualTask">
		<joinType>AND</joinType>
		<splitType>XOR</splitType>
	</task>
  </tasks>
  <flows>
  	<flow><from>start</from><to>managerApproval</to></flow>
	  <flow><from>managerApproval</from><to>sendRequestCorrection</to></flow>
	  <flow><from>managerApproval</from><to>completeOrderItems</to></flow>
	  <flow><from>sendRequestCorrection</from><to>managerApproval</to></flow>
	  <flow><from>completeOrderItems</from><to>deliverOrderItems</to></flow>
	  <flow><from>deliverOrderItems</from><to>confirmOrderComplete</to></flow>
	  <flow><from>confirmOrderComplete</from><to>end</to></flow>
	  <flow><from>confirmOrderComplete</from><to>completeOrderItems</to></flow>
  </flows>
    <processDataTypes>
        <struct name="OrderItem">
            <member name="code" type="string" required="true" />
            <member name="name" type="string" required="true" />
            <member name="quantity" type="int" required="true" />
        </struct>
    </processDataTypes>
  	<variables>
		<variable name="requestedById" type="string" required="true" dir="In" />
        <variable name="requestedByName" type="string" required="false" dir="In" />
        <variable name="requestDate" type="date" required="false" dir="In" />
        <variable name="orderItem" type="OrderItem" required="true" isArray="true" dir="In" />
	  </variables>
</process>